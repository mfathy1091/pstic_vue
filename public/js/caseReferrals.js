"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[725],{6513:(e,r,a)=>{a.r(r),a.d(r,{default:()=>n});a(5714);var s=a(3319),t=a(7907),l=a.n(t),o=(a(115),a(5480));const i={name:"caseeReferrals",components:{Multiselect:l(),ReferralModal:s.Z},mixins:[o.Z],props:{caseeId:{required:!0}},data:function(){return{caseeReferrals:[],referralEditMode:!1,selectedReferral:{}}},methods:{showCreateReferralModal:function(){this.referralEditMode=!1,this.selectedReferral={},$("#referralModal").modal("show")},showEditReferralModal:function(e){this.referralEditMode=!0,this.selectedReferral=e,$("#referralModal").modal("show")}},created:function(){var e=this;this.getCaseeReferrals(this.caseeId),Fire.$on("caseebeneficiariesChanged",(function(){e.getCasee(e.caseeId)})),Fire.$on("caseeReferralsChanged",(function(){e.getCaseeReferrals(e.caseeId)}))}};const n=(0,a(1900).Z)(i,(function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{staticClass:"card-body"},[a("div",{staticClass:"row ml-2"},[a("button",{staticClass:"btn btn-success btn-sm mr-2",on:{click:e.showCreateReferralModal}},[a("i",{staticClass:"fas fa-plus-circle"}),e._m(0)]),e._v(" "),a("button",{staticClass:"btn btn-secondary btn-sm",on:{click:function(r){return e.getCaseeReferrals(e.caseeId)}}},[a("i",{staticClass:"fas fa-sync-alt"})])]),e._v(" "),a("div",{staticClass:"row mt-3"},[a("p",{directives:[{name:"show",rawName:"v-show",value:!e.caseeReferrals.length,expression:"!caseeReferrals.length"}],staticClass:"font-italic ml-5"},[e._v("This case has no referrals!")]),e._v(" "),a("table",{directives:[{name:"show",rawName:"v-show",value:e.caseeReferrals.length,expression:"caseeReferrals.length"}],staticClass:"border table table-hover table-sm"},[e._m(1),e._v(" "),this.caseeReferrals?a("tbody",e._l(this.caseeReferrals,(function(r){return a("tr",{key:r.id},[a("td",[e._v(e._s(r.referral_source.name))]),e._v(" "),a("td",[e._v(e._s(e._f("myDate")(r.referral_date)))]),e._v(" "),a("td",[a("div",{staticClass:"list-unstyled"},e._l(r.records,(function(r,s){return a("li",{key:r.id},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==s,expression:"i==0"}]},[a("span",[e._v(e._s(r.month.name))]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"Inactive"==r.status.name,expression:"record.status.name == 'Inactive'"}],staticClass:"badge badge-pill badge-secondary"},[e._v(e._s(r.status.name))]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"Active"==r.status.name,expression:"record.status.name == 'Active'"}],staticClass:"badge badge-pill badge-success"},[e._v(e._s(r.status.name))]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"Closed"==r.status.name,expression:"record.status.name == 'Closed'"}],staticClass:"badge badge-pill badge-dark"},[e._v(e._s(r.status.name))]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:1==r.is_new,expression:"record.is_new == 1"}],staticClass:"badge badge-pill badge-info"},[e._v("New")])])])})),0)]),e._v(" "),a("td",[e._v(e._s(r.current_assigned_psw.full_name))]),e._v(" "),a("td",[a("router-link",{staticClass:"fa fa-eye blue align-middle mr-2",attrs:{to:{name:"referralDetails",params:{caseeId:e.caseeId,referralId:r.id}}}}),e._v(" "),a("a",{staticClass:"clickable",on:{click:function(a){return e.showEditReferralModal(r)}}},[a("i",{staticClass:"fas fa-pencil-alt blue mr-2"})]),e._v(" "),e._m(2,!0)],1)])})),0):e._e()])]),e._v(" "),a("ReferralModal",{attrs:{"v-if":e.selectedReferral.id,referralEditMode:e.referralEditMode,selectedReferral:e.selectedReferral},on:{referralsChanged:function(r){return e.getCasee()}}})],1)}),[function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("span",[a("b",[e._v(" Referral")])])},function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("thead",[a("tr",[a("th",[e._v("Source")]),e._v(" "),a("th",[e._v("Referral Date")]),e._v(" "),a("th",[e._v("Current Month Status")]),e._v(" "),a("th",[e._v("Assigned Worker")]),e._v(" "),a("th",[e._v("Actions")])])])},function(){var e=this.$createElement,r=this._self._c||e;return r("a",{staticClass:"clickable"},[r("i",{staticClass:"fa fa-trash red"})])}],!1,null,"2d5b486a",null).exports},3319:(e,r,a)=>{a.d(r,{Z:()=>i});var s=a(5714),t=a(7907),l=a.n(t);const o={mixins:[a(5480).Z],components:{Multiselect:l()},props:{referralEditMode:Boolean,selectedReferral:Object},data:function(){return{caseebeneficiaries:[],directIndividual:"",referralSources:[],nationalities:[],referralReasons:[],users:[],roles:[],referralForm:new s.ZP({id:"",referral_source_id:"",referral_date:"",referring_person_name:"",referring_person_email:"",referral_narrative_reason:"",referral_reasons:[],casee_id:""})}},watch:{selectedReferral:function(e,r){this.referralForm.fill(this.selectedReferral),this.referralForm.casee_id=this.$route.params.caseeId}},methods:{createReferral:function(){var e=this;this.$Progress.start(),this.referralForm.post("/api/referrals").then((function(r){$("#referralModal").modal("hide"),Fire.$emit("caseeReferralsChanged"),e.createdReferral=r.data.referral,Toast.fire({icon:"success",title:"Added successfully"}),e.$Progress.finish()})).catch((function(r){e.$Progress.fail(),console.log(r)}))},updateReferral:function(){var e=this;this.$Progress.start(),this.referralForm.put("/api/referrals/"+this.referralForm.id).then((function(){Fire.$emit("caseeReferralsChanged"),$("#referralModal").modal("hide"),Swal.fire("Updated!","It has been updated.","success"),e.$Progress.finish()})).catch((function(){e.$Progress.fail()}))}},created:function(){this.getReferralSources(),this.getNationalities(),this.getReferralReasons()}};const i=(0,a(1900).Z)(o,(function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{staticClass:"modal fade",attrs:{id:"referralModal",tabindex:"-1","aria-labelledby":"referralModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{directives:[{name:"show",rawName:"v-show",value:!e.referralEditMode,expression:"!referralEditMode"}],staticClass:"modal-title",attrs:{id:"referralModalLabel"}},[e._v("Create New Referral")]),e._v(" "),a("h5",{directives:[{name:"show",rawName:"v-show",value:e.referralEditMode,expression:"referralEditMode"}],staticClass:"modal-title",attrs:{id:"referralModalLabel"}},[e._v("Edit Referral")]),e._v(" "),e._m(0)]),e._v(" "),a("form",{on:{submit:function(r){r.preventDefault(),e.referralEditMode?e.updateReferral():e.createReferral()}}},[a("div",{staticClass:"modal-body"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label",attrs:{for:"referral_source_id"}},[e._v("Referral Source")]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.referralForm.referral_source_id,expression:"referralForm.referral_source_id"}],staticClass:"form-control",class:{"is-invalid":e.referralForm.errors.has("referral_source_id")},attrs:{name:"referral_source_id",id:"referral_source_id"},on:{change:function(r){var a=Array.prototype.filter.call(r.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.referralForm,"referral_source_id",r.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"0",disabled:""}},[e._v("Choose...")]),e._v(" "),e._l(e.referralSources,(function(r){return a("option",{key:r.id,domProps:{value:r.id}},[e._v(e._s(r.name))])}))],2),e._v(" "),a("HasError",{attrs:{form:e.referralForm,field:"referral_source_id"}})],1),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label",attrs:{for:"referral_date"}},[e._v("Referral Date")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.referralForm.referral_date,expression:"referralForm.referral_date"}],staticClass:"form-control",attrs:{id:"referral_date",type:"text",name:"referral_date",autocomplete:"off",placeholder:"YYYY-MM-DD"},domProps:{value:e.referralForm.referral_date},on:{input:function(r){r.target.composing||e.$set(e.referralForm,"referral_date",r.target.value)}}}),e._v(" "),a("HasError",{attrs:{form:e.referralForm,field:"referral_date"}})],1),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label",attrs:{for:"referring_person_name"}},[e._v("Referring Person Name")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.referralForm.referring_person_name,expression:"referralForm.referring_person_name"}],staticClass:"form-control",attrs:{id:"referring_person_name",type:"text",name:"referring_person_name"},domProps:{value:e.referralForm.referring_person_name},on:{input:function(r){r.target.composing||e.$set(e.referralForm,"referring_person_name",r.target.value)}}}),e._v(" "),a("HasError",{attrs:{form:e.referralForm,field:"referring_person_name"}})],1),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label",attrs:{for:"referring_person_email"}},[e._v("Referring Person Email")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.referralForm.referring_person_email,expression:"referralForm.referring_person_email"}],staticClass:"form-control",attrs:{id:"referring_person_email",type:"email",name:"referring_person_email"},domProps:{value:e.referralForm.referring_person_email},on:{input:function(r){r.target.composing||e.$set(e.referralForm,"referring_person_email",r.target.value)}}}),e._v(" "),a("HasError",{attrs:{form:e.referralForm,field:"referring_person_email"}})],1),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"typo__label"},[e._v("Referral Reasons")]),e._v(" "),a("multiselect",{attrs:{options:e.referralReasons,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pick some",label:"name","track-by":"name","preselect-first":!0},model:{value:e.referralForm.referral_reasons,callback:function(r){e.$set(e.referralForm,"referral_reasons",r)},expression:"referralForm.referral_reasons"}})],1),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label",attrs:{for:"referral_narrative_reason"}},[e._v("Referral Narrative Reason")]),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.referralForm.referral_narrative_reason,expression:"referralForm.referral_narrative_reason"}],staticClass:"form-control",attrs:{rows:"3",name:"referral_narrative_reason"},domProps:{value:e.referralForm.referral_narrative_reason},on:{input:function(r){r.target.composing||e.$set(e.referralForm,"referral_narrative_reason",r.target.value)}}}),e._v(" "),a("HasError",{attrs:{form:e.referralForm,field:"referral_narrative_reason"}})],1)]),e._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-danger",attrs:{type:"button","data-dismiss":"modal"}},[e._v("Close")]),e._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:!e.referralEditMode,expression:"!referralEditMode"}],staticClass:"btn btn-success",attrs:{type:"submit"}},[e._v("Create")]),e._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:e.referralEditMode,expression:"referralEditMode"}],staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("Update")])])])])])])}),[function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])}],!1,null,null,null).exports}}]);
//# sourceMappingURL=caseReferrals.js.map